
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.3.1, mkdocs-material-8.5.2" name="generator"/>
<title>Docker Compose - Notes Collection</title>
<link href="../../assets/stylesheets/main.9f9400aa.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.cbb835fc.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="pink" data-md-color-scheme="default" dir="ltr">
<script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#docker-compose">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Notes Collection" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Notes Collection">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Notes Collection
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Docker Compose
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="pink" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="blue" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="pink" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"></path></svg>
</label>
</form>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Notes Collection" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Notes Collection">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
    Notes Collection
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
        Notes Index
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2">
          About Me
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="About Me" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
          About Me
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../About%20Me/Abhishek%27s%20Profile/">
        Abhishek's Profile
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3">
          Container and Orchestration
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Container and Orchestration" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
          Container and Orchestration
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../About%20Docker/">
        Docker Notes
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../CI%20with%20Travis/">
        Travis based Continuous Integration
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<a class="md-nav__link md-nav__link--active" href="./">
        Docker Compose
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Docker-Commands/">
        Docker Commands Cheat sheet
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Docker-Swarm/">
        Introduction to Swarm
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Kubernetes/">
        Simple Kubernetes Project
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Simple%20Docker%20Project/">
        Compile simple project in docker
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4">
          Data Management
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Data Management" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
          Data Management
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../Data%20Management/Snowflake-Vs.-Databricks/">
        Snowflake Vs. Databricks
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="docker-compose">Docker Compose<a class="headerlink" href="#docker-compose" title="Permanent link">¶</a></h1>
<p>Instructions below are based on following the directions provided during the course :  Docker for developers by Emmanuel Henri - <a href="https://www.linkedin.com/learning/docker-for-developers-14493163/docker-for-developers?autoplay=true&amp;resume=false">Docker for developers (linkedin.com)</a></p>
<hr/>
<ul>
<li>Follow the steps below to develop a full stack service comprising of multiple containers.</li>
<li>The instructions for developing a full stack are written the docker compose .yml file. Look at the sample project developed available at the GitHub  - <a href="https://github.com/abhishekgupta-myrepo/docker_poc">abhishekgupta-myrepo/docker_poc (github.com)</a></li>
<li>Once the docker compose file is written preform the following steps to create a service.</li>
<li><strong>Step 1</strong> : Run the below command to create images for all the services that form part of the full stack and must be deployed as a single unit.</li>
</ul>
<pre><code class="language-bash">PS C:\Users\abhis\Projects\docker_poc&gt; docker-compose build
[+] Building 22.1s (11/11) FINISHED
 =&gt; [internal] load build definition from Dockerfile                                                      0.0s
 =&gt; =&gt; transferring dockerfile: 155B                                                                      0.0s
 =&gt; [internal] load .dockerignore                                                                         0.0s
 =&gt; =&gt; transferring context: 66B                                                                          0.0s
 =&gt; [internal] load metadata for docker.io/library/node:latest                                            1.7s
 =&gt; [auth] library/node:pull token for registry-1.docker.io                                               0.0s
 =&gt; [1/5] FROM docker.io/library/node@sha256:8a45c95c328809e7e10e8c9ed5bf8374620d62e52de1df7ef8e71a9596e  0.0s
 =&gt; [internal] load build context                                                                         0.3s
 =&gt; =&gt; transferring context: 16.08MB                                                                      0.3s
 =&gt; CACHED [2/5] WORKDIR /usr/src/app                                                                     0.0s
 =&gt; [3/5] COPY package*.json ./                                                                           0.1s
 =&gt; [4/5] RUN npm install                                                                                18.3s
 =&gt; [5/5] COPY . .                                                                                        0.1s
 =&gt; exporting to image                                                                                    1.4s
 =&gt; =&gt; exporting layers                                                                                   1.4s
 =&gt; =&gt; writing image sha256:3b656d9f2fa551b00589d89b61f563f07c33c7f8eb2a2ce191a7b6d2d6c14576              0.0s
 =&gt; =&gt; naming to docker.io/library/docker_poc-app                                                         0.0s

Use 'docker scan' to run Snyk tests against images to find vulnerabilities and learn how to fix them
</code></pre>
<ul>
<li><strong>Step 2</strong> : Run the following command to spin up specific container to be created as part of the full stack. <ul>
<li>Note: Even if you bring up each container one at a time even then all the containers form part of the stack. </li>
<li>Make sure to trigger the containers in the order so that the other container does not fail that is dependent upon the other container for successful boot. This is done by mentioning the specific container to kickoff</li>
<li>Reason for specifying the -d and mentioning the container that needs to start first is that docker compose will start all the containers in parallel and will run into issues if the database is not up.</li>
</ul>
</li>
</ul>
<pre><code class="language-bash">PS C:\Users\abhis\Projects\docker_poc&gt; docker-compose up -d mongo
[+] Running 10/10
 - mongo Pulled                                                                                          19.8s
   - 675920708c8b Pull complete                                                                           5.8s
   - 6f9c8c301e0f Pull complete                                                                           5.9s
   - 73738965c4ce Pull complete                                                                           6.3s
   - 7fd6635b9ddf Pull complete                                                                           6.9s
   - 73a471eaa4ad Pull complete                                                                           7.0s
   - bcf274af89b0 Pull complete                                                                           7.1s
   - 04fc489f2a3b Pull complete                                                                           7.2s
   - 6eff8a505292 Pull complete                                                                          18.6s
   - a5ef4431fce7 Pull complete                                                                          18.6s
[+] Running 2/2
 - Network docker_poc_default  Created                                                                    0.0s
 - Container mongo             Started                                                                    1.1s
PS C:\Users\abhis\Projects\docker_poc&gt; 
</code></pre>
<ul>
<li><strong>Step 3</strong> : Run the below command to look into the logs of specific container.<ul>
<li>This is not a core part of the sequence of instructions to spin up this stack and is just to validate the state of the containers. </li>
</ul>
</li>
</ul>
<pre><code class="language-bash">PS C:\Users\abhis\Projects\docker_poc&gt; docker logs e74cd
{"t":{"$date":"2022-09-15T20:59:49.287+00:00"},"s":"I",  "c":"NETWORK",  "id":4915701, "ctx":"-","msg":"Initialized wire specification","attr":{"spec":{"incomingExternalClient":{"minWireVersion":0,"maxWireVersion":17},"incomingInternalClient":{"minWireVersion":0,"maxWireVersion":17},"outgoing":{"minWireVersion":6,"maxWireVersion":17},"isInternalClient":true}}}

</code></pre>
<ul>
<li><strong>Step 4</strong> : Run the below command to stop all the containers that form part of a stack built through the docker compose.<ul>
<li>Stopping all the containers can be done by a single command</li>
<li>Make sure to stop the <mark>docker compose stop</mark> to stop the service else if you stop the containers individually they will spin up again.</li>
</ul>
</li>
</ul>
<pre><code class="language-bash">PS C:\Users\abhis\Projects\docker_poc&gt; docker-compose stop
[+] Running 2/2
 - Container app    Stopped                                                                               1.0s 
 - Container mongo  Stopped 
</code></pre>
<ul>
<li>Once the docker compose is ready for deployment it can be used for deployment through container orchestration tools such as - <ul>
<li>Docker Swarm: look at the notes @ <a href="../Docker-Swarm/">Docker-Swarm</a>. This is native to Docker and comes installed with docker desktop.</li>
<li>Kubernetes: look at the notes @<a href="../Kubernetes/">Kubernetes</a>. It is the current industry standard. Instead of setting up your own Kubernetes cluster most common practice is to use it as a managed services through cloud providers such as GCP or AWS.</li>
<li>Mesos</li>
</ul>
</li>
</ul>
<hr/>
<ul>
<li>These notes are based on my understanding of the topic. Some of the content and images refers to the online articles, learning courses I attended. I encourage you to lookup the links provided to develop your own understanding of it at deeper level.</li>
<li>The intention of these notes is to serve as reference marker to other sites, online courses, books that I found useful while learning about it.</li>
<li>If you would like to share any thoughts or give comments please feel free to reach me @ abhishekgupta86@gmail.com or @ www.linkedin.com/in/abhishekgupta86</li>
</ul>
<hr/>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: Travis based Continuous Integration" class="md-footer__link md-footer__link--prev" href="../CI%20with%20Travis/" rel="prev">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</div>
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Previous
              </span>
              Travis based Continuous Integration
            </div>
</div>
</a>
<a aria-label="Next: Docker Commands Cheat sheet" class="md-footer__link md-footer__link--next" href="../Docker-Commands/" rel="next">
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Next
              </span>
              Docker Commands Cheat sheet
            </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
<script src="../../assets/javascripts/bundle.39f04ddb.min.js"></script>
<script src="../../javascripts/mathjax.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</body>
</html>